{% extends 'base.html' %}

{% block content %}

<!-- Button to create a new project -->
<a href="{{ url_for('main.create_project') }}" class="btn btn-primary">Create New Project</a>

<div class="container">
    <!-- Navbar for Add New Project -->
    <nav class="navbar navbar-expand-lg navbar-light mb-4" style="background-color: transparent; box-shadow: none;">
        <div class="container-fluid">
            <!-- Align "Add New Project" button to the right -->
        </div>
    </nav>

      <!-- Navbar for Filter List (Visible if projects count >= 1) -->
      {% if projects|length >= 1 %}
      <nav class="navbar navbar-expand-lg navbar-light mb-4" style="background-color: transparent; box-shadow: none;">
          <div class="container-fluid">
              <!-- Align "Filter List" button to the right -->
              <div class="d-flex ms-auto">
                  <button id="filter-toggle-btn" class="btn btn-primary">
                      FILTER
                  </button>
              </div>
          </div>
      </nav>
      {% endif %}

      <form method="GET" action="{{ url_for('main.list_projects') }}" class="form-inline mb-4" id="filter-form" style="display: none;">
        <div class="form-group me-3">
          <label for="project" class="me-2">Project Name:</label>
          <select name="project" id="project" class="form-control">
            <option value="">All</option>
            {% for p in all_projects %}
            <option value="{{ p.id }}" {% if project_id_filter == p.id %}selected{% endif %}>{{ p.name }}</option>
            {% endfor %}
          </select>
        </div>
      
        <div class="form-group me-3">
          <label for="status" class="me-2">Status:</label>
          <select name="status" id="status" class="form-control">
            <option value="">All</option>
            {% for status in all_statuses %}
            <option value="{{ status }}" {% if status_filter == status %}selected{% endif %}>{{ status }}</option>
            {% endfor %}
          </select>
        </div>
      
        <div class="form-group">
          <button type="submit" class="btn btn-primary">Apply Filter</button>
        </div>
      </form>
      


<table class="styled-table">
    <thead>
        <tr>
         <!---  <th>#</th> -->
            <th>Project Name</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Status</th>
            <th>Actions</th>

        </tr>
    </thead>
    <tbody>
        {% for project in projects %}
        <tr>
           <!--- <td>{{ loop.index }}</td> -->
            <td>{{ project.name }}</td>
            <td>{{ project.start_date.strftime('%Y-%m-%d') }}</td>
            <td>{{ project.end_date.strftime('%Y-%m-%d') }}</td>
            <td><span class="badge {{ project.status|lower|replace(' ', '-') }}">{{ project.status }}</span></td>

            <td>
                <!-- Edit & Delete link for each project -->
                <a href="{{ url_for('main.edit_project', project_id=project.id) }}" style="color: #28a745; font-size: 20px; cursor: pointer;" title="Edit Project">
                    üñäÔ∏è
                </a>          
                <form action="{{ url_for('main.delete_project', project_id=project.id) }}" method="POST" style="display:inline;">
                    <button type="submit" style="border: none; background: transparent; color: #dc3545; cursor: pointer;" title="Delete Project", onclick="return confirm('Are you sure you want to delete this project? If yes, take note all associated tasks will also be deleted')">
                        üóëÔ∏è
                    </button>
                </form>

            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% if pagination.pages > 1 %}
<nav aria-label="Project pagination">
  <ul class="pagination justify-content-center mt-4">
    {% if pagination.has_prev %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('main.list_projects', page=pagination.prev_num) }}">Previous</a>
      </li>
    {% endif %}
    <li class="page-item disabled">
      <span class="page-link">Page {{ pagination.page }} of {{ pagination.pages }}</span>
    </li>
    {% if pagination.has_next %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('main.list_projects', page=pagination.next_num) }}">Next</a>
      </li>
    {% endif %}
  </ul>
</nav>
{% endif %}

  

{% endblock %}
